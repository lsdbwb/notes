# 进程
异常是操作系统内核创建进程概念的基础。

## 进程的定义
进程是一个执行中程序的实例

### 进程上下文
系统中的每个程序都运行在某个进程的上下文（context）中

**上下文的组成：**
- 内存中程序的代码和数据
- 栈
- 通用目的寄存器上的内容
- 程序计数器
- 环境变量
- 打开文件描述符表的集合
- 。。。

**上下文的切换：**

## 进程给应用程序提供的关键抽象
1. 一个*独立的逻辑控制流*。提供一个假象：好像我们的程序独占地使用处理器，进程之间的执行互不干扰

如下图所示，处理器的一个物理控制流被划分为3个逻辑控制流，每个进程一个。三个逻辑流的执行是交错的，这三个进程轮流使用处理器；每个进程执行其逻辑流的一部分，然后被抢占（暂时挂起），然后轮到其他进程
![[Pasted image 20220615171601.png]]
对于一个运行在以上某个进程之中的程序来说，它看上去就像是在独占地使用处理器

**并发流**
一个逻辑流的执行在时间上与另一个流重叠，称为并发流（concurrent flow), 这两个流被称为并发地运行。

多个流并发地执行的一般现象被称为并发（concurrency)。一个进程和其他进程轮流运行的概念称为多任务（multitasking)。一个进程执行它的控制流的一部分的每一时间段叫做时间片（time slice) 因此，多任务也叫做时间分片（time slicing)

2. 一个*私有的地址空间*。提供一个假象：好像我们的程序独占地使用内存系统

进程也为每个程序提供一种假象，好像它独占地使用系统地址空间。在一台32位地址的机器上，地址空间是2^32个可能地址的集合，0，1，... 2^32 -1。进程为每个程序提供它自己的*私有地址空间*

每个进程的地址空间的组织结构是相同的，如下所示
![[Pasted image 20220615172648.png]]
- 地址空间顶部保留给内核（操作系统常驻内存的部分）
- 地址空间底部留给用户使用（包括从可执行文件加载的代码段、数据段、.bss段；共享库的内存映射区域、运行时需要的用户栈和堆区）

## 用户模式和内核模式
### 为什么需要划分为两种执行模式
因为一个系统中可能会有多个进程，每个进程是由操作系统内核进行管理的，包括维护和管理进程相关的数据结构，进行进程的上下文切换等操作。进程中的应用程序在执行时不应该影响进程本身的数据结构，因此需要对应用程序做出限制，避免程序员写出错误的代码

为了使操作系统内核提供一个无懈可击的进程抽象，处理器必须提供一种机制，限制一个应用可以执行的指令以及它可以访问的地址空间范围

### 如何实现








