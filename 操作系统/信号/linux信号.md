# 信号的概念
1.  Linux信号是更高层的软件形式的异常，它允许进程和内核中断另外一个进程
2. 一个信号就是一个小消息，它通知进程系统中发生了一个某种类型的事件
3. 低层的硬件异常是由内核异常处理程序处理的，正常情况下，对用户进程而言是不可见的。信号提供了一种机制，通知用户进程发生了这些异常

Linux支持多种信号，每种信号对应一种系统事件
![[Pasted image 20220616153303.png]]

# 发送信号和接收信号
## 发送信号
内核通过更新目的进程上下文中的某个状态，发送（递送）一个信号给目
的进程

**发送信号的原因：**
1. 内核检测到一个系统事件，比如除0错误或者子进程终止
2. 一个进程调用了kill函数，主动发送信号给另一个进程

**unix发送信号的机制**
1. 进程组
	每个进程都只属于一个进程组，进程组是由一个正整数进程组ID 来标识的
	默认地，一个子进程和它的父进程同属于一个进程组

	发送信号时，要么指定某个具体的进程，要么会发送到整个进程组的所有进程
2. 使用 /bin/kill 发送信号
3. 使用键盘发送信号
	例如 CTRL + C会发送终止信号给所有前台进程
4. 用kill函数发送信号
5. 用alarm函数发送信号

## 接收信号
当目的进程被内核强迫以某种方式对信号的发送做出反应时，它就接收了
信号

**接受信号的时机**：
当内核把进程p从内核态切换回用户态时（从系统调用返回或者上下文切换），会检查进程p的*未被阻塞的待处理信号的集合*。如果集合非空，则选择某个信号k（通常是最小的k），然后强制进程p接收信号k。进程p会根据信号类型做以下处理：
- 进程终止。
- 进程终止并转储内存。
- 进程停止(挂起)直到被SIGCONT 信号重启。
* 进程忽略该信号

**接收信号后可能的处理**：
1. 直接忽略信号
2. 调用预先定义好的信号处理程序
![[Pasted image 20220616154056.png]]
3. 直接终止


## 信号接收和发送的一些特点
发出而未接收的信号被称为*待处理信号*，一种信号类型只可能有一个待处理信号。如果一个进程有一个类型为k的待处理信号，那么任何接下来发送到这个进程的类型为k的信号都不会排队等待；它们只是被简单地丢弃。

进程可以选择阻塞接收某些信号

一个待处理信号最多只能被接收一次。内核为每个进程在pending 位向量中维护着待处理信号的集合，而在blocked 位向量中维护着被阻塞的信号集合。只要传送了一个类型为k的信号，内核就会设置pending 中的第k位，而只要接收了一个类型为k的信号，内核就会清除penaing中的第k位。


![[Pasted image 20220616161717.png]]