# 最简单的流程
## 直接使用IP地址
![](https://static001.geekbang.org/resource/image/8a/19/8a5bddd3d8046daf7032c7d60a3d1a19.png)

简要叙述一下这次最简单的浏览器HTTP请求过程：

1.  浏览器从地址栏的输入中获得服务器的IP地址和端口号；
    
2.  浏览器用TCP的三次握手与服务器建立连接；
    
3.  浏览器向服务器发送拼好的报文；
    
4.  服务器收到报文后处理请求，同样拼好报文再发给浏览器；
    
5.  浏览器解析报文，渲染输出页面。

## 使用域名
- 因为浏览器不知道web服务器的IP地址，所以需要使用DNS的域名解析功能得到IP地址
- 实际的域名解析有多级缓存，不用每次都通过网络向域名服务器查询
- 域名查询流程
	1. 查看浏览器自己的缓存
	2. 查看操作系统的缓存
	3. 检查本机域名解析文件hosts

# 现实的流程
![[Pasted image 20220524201846.png]]
1. 假如访问某个网址www.xxx.com，首先要使用DNS做域名解析，获得该网址的IP地址
2. DNS可能会给出内容分发网络(CDN)的IP地址，CDN会缓存网站的大部分资源，如图片，CSS样式表
3. CDN只能缓存静态资源，不能缓存动态资源，因此http请求会通过无数的路由器、网关、代理直到到达web服务器
4. 目标网站对外表现为一个IP，内部也是一套复杂的结构。首先是做负载均衡的反向代理服务器。代理服务器后面是服务器集群，首先将请求发送给缓存服务器，如果缓存服务器里没有内容，再发送给应用服务器。应用服务器再去数据库里进行查询，并将结果返回给代理服务器，并在缓存服务器中存一份，代理服务器再把http响应沿路发回给客户端，中途可能缓存在多个地方
5. http响应到达客户端后，浏览器解析处理才能显示出来，如果数据里还有超链接，则还要走一遍相同的流程，直到所有的资源都下载完