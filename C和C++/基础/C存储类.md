
# C语言存储类的概念
C语言为变量提供了5种不同的存储模型，被称为存储类

# 存储类由以下三种属性组合定义
## 1.作用域
作用域描述了程序中可以访问一个标识符的一个或者多个区域。C变量的作用域可以是以下三种：
- 代码块作用域
	一个代码块是包含在一对花括号中的代码。例如整个函数体是一个代码块，一个函数内的任一复合语句也是一个代码块。
	
	在一个代码块中定义的变量具有代码块作用域，函数的形参虽然定义在花括号之前，但是也具有代码块作用域
	
- 函数原型作用域
是指的函数声明时，形参列表里使用的变量名
![[Pasted image 20220619114558.png]]

- 文件作用域
一个在*所有函数之外*定义的变量具有文件作用域
具有文件作用域的变量从他的定义处到文件结尾都是可见的

## 2.链接
一个C变量具有以下三种链接属性
- 外部链接（external linkage）
	具有外部链接的变量可以在一个或多个文件中使用
- 内部链接（internal linkage）
	具有内部链接的变量只能在一个文件内使用
- 空链接（no linkage)
	具有代码块作用域和函数原型作用域的变量具有空链接，具有空链接的变量是由其所在的代码块或者函数原型私有的
	

## 3.存储时期
一个C变量有两种存储时期：
- 静态存储时期（static storage duration）
	变量在程序执行期间一直存在
- 自动存储时期（automatic storage duration）
	具有代码块作用域的变量一般具有自动存储时期。在程序进入定义这些变量的代码块时，变量被分配内存，退出这些代码块时，变量的内存被释放
	
# 五种存储类
![[Pasted image 20220620090536.png]]
## 1.自动变量
属于自动存储类的变量具有自动存储时期、代码块作用域和空链接

在代码块或者函数头部定义的变量都属于自动变量

可以使用存储类说明符auto显式地定义一个变量为自动变量

自动变量不会被初始化，需要自己显式地初始化

## 2. 寄存器变量
通常变量存储在内存中，如果变量能够存在寄存器或者高速缓存中，那么访问和操作该变量的速度将会大大加快。

使用存储类说明符register来声明一个寄存器变量

声明寄存器变量仅仅是一个*请求*，而非一条直接的命令。由编译器根据你的请求和实际系统的情况做权衡

无法获得寄存器变量的地址，不能对寄存器变量使用取地址运算符（即使该寄存器变量实际可能在内存中）

## 3. 具有代码块作用域的静态变量
```c++
// x为一个具有代码块作用域的静态变量
void fun(){
	static int x;
}
```
如上所示，变量在代码块内部使用static关键字定义。变量仍然具有代码块作用域，但是在程序离开代码段时，变量并不会消失，变量因为static关键字而具有了静态存储时期（在整个程序执行期间变量都存在）

## 4. 具有外部链接的静态变量
具有外部链接的静态变量具有文件作用域、外部链接和静态存储时期

把变量的定义声明放在所有函数之外，即定义了一个具有外部链接的静态变量

如果不对外部变量进行显式地初始化，外部变量默认被初始化为0

可以使用存储类说明符extern来重新声明在另一个文件中定义的外部变量

## 5. 具有内部链接的静态变量
具有内部链接的静态变量具有文件作用域、内部链接和静态存储时期

如何声明和定义：在具有外部链接的静态变量加上static关键字

内部链接意味着*只能在本文件*访问和操作该变量


# 存储类和函数
函数也具有存储类
函数有三种类型：
- 外部函数：可被其他文件中的程序调用
- 静态函数：只能在定义它的文件中使用
- 内联函数

函数默认都是外部函数，可以在另一个文件中使用extern重新声明

使用static存储类的原因之一就是创建一个特定模块私有的函数，从而避免可能的命名冲突

