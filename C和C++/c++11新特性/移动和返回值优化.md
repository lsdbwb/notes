# RVO(返回值优化)
用于函数返回一个右值时

如下例所示，编译器会直接把T对象构造到调用者的栈上去
![[Pasted image 20220714145035.png]]

C++17 强制编译器做 RVO，RVO 不再是一项可选的编译器优化，而是 C++ 对 prvalue 的新规定，即返回和使用 prvalue 时不再去实体化一个临时对象


# NRVO(具名返回值优化)
如下图所示：
![[Pasted image 20220714145148.png]]


C++11 开始，NRVO 仍可以发生，但在没有 NRVO 的情况下，编译器将试图把本地对象**移动出去**，而不是拷贝出去

这一移动行为不需要程序员手工用 std::move 进行干预，使用 std::move 对于移动行为没有帮助，反而会影响返回值优化，因为这种情况下，你返回的并不是局部对象，而是局部对象的引用


